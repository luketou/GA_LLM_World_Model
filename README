
# ğŸ“œ ç›®æ¨™  
æ‰“é€ ä¸€å¥—ã€ŒLLM Agent ( LangGraph ) + Graph-GA ç”Ÿæˆ + World Model + Risk Gateã€å®Œæ•´å·¥ä½œæµï¼Œ  
å¯åœ¨ **GuacaMol benchmark_suites** ä»»å‹™ä¸Šè©•æ¸¬åˆ†å­è¨­è¨ˆè¡¨ç¾ï¼Œä¸¦æ”¯æ´é–‰ç’° Oracle ç²¾è©•ï¼Œä¸¦è¨­å®šoracle åªæœ‰500æ¬¡ï¼ŒåŒæ™‚è¦å¯¦æ™‚è¿½è¹¤llmgenerator å’ŒGB_GA_generate oracle ç´¯ç©ã€‚  
ç¨‹å¼èªè¨€ **Python 3.9**ï¼›æ ¸å¿ƒæ¡†æ¶ **PyTorch 2**ã€**PyTorch Geometric 2**ã€**RDKit**ã€**LangGraph**ã€‚  
æ‰€æœ‰æŒ‡ä»¤å¯ç›´æ¥åœ¨ *nix shell å…§ä¸€æ¬¡åŸ·è¡Œï¼Œç„¡éœ€æ‰‹å‹•ä¿®æ”¹ä»»ä½•è·¯å¾‘ã€‚  

# ğŸ“‚ æª”æ¡ˆçµæ§‹  
- `agent/`
  - `llm_agent.py`          â† LangGraph LLM Agentï¼šè² è²¬ prompt-planningã€Few-shotã€éŒ¯èª¤åé¥‹  
  - `graph_ga_wrapper.py`   â† åŒ…è£ BenevolentAI **GB_GA_generate**ï¼ˆé€é `pip install guacamol_baselines` å–å¾—ï¼‰  
  - `policy.py`             â† Meta-controllerï¼šåŸºæ–¼æ­·å²å¾—åˆ†æ±ºå®šæ¡ç”¨ LLM é‚„æ˜¯ Graph-GA  
- `world_model/`
  - `data_utils.py`         â† SMILES â†’ 2D/3D/motif ç‰¹å¾µåœ–  
  - `encoder.py`            â† Uni-Mol é¢¨æ ¼ SE(3)-Transformerï¼ˆå¯è¼‰é è¨“ç·´æ¬Šé‡ï¼‰  
  - `task_encoder.py`       â† one-hot + é€£çºŒé–€æª» + é‹ç®—ç¬¦ Embedding â†’ 128-dim  
  - `heads.py`              â† åˆæˆ / æ€§è³ª / æ¯’æ€§ / é‡å­ å¤šé ­ + MC-Dropout Ïƒ  
  - `gate.py`               â† Risk Gate (MLP)ï¼šè¼¸å‡º `[0,1]` risk  
  - `planner.py`            â† Retrosynthesis stubï¼ˆTransformer + MCTSï¼Œå¯å¾ŒçºŒæ›¿æ›ï¼‰  
  - `config.py`             â† è¶…åƒã€æ¬Šé‡ã€é–€æª»è¨­å®š  
- `oracle/`
  - `dft_proxy.py`          â† ä½”ä½ï¼šç”¨é«˜éš ML (Chemprop) æ¨¡æ“¬æ˜‚è²´ DFTï¼›æ˜“æ–¼æ”¹æˆçœŸ DFT/å¯¦é©—  
- `training/`
  - `train_pretrain.py`     â† è‡ªç›£ç£é è¨“ç·´ (é®è”½ã€å°æ¯”ã€3D é‡å»º)  
  - `train_finetune.py`     â† å¤šé ­å¼±ç›£ç£å¾®èª¿  
- `benchmark/`
  - `guacamol_runner.py`    â† èˆ‡ `guacamol.benchmark_suites` å°æ¥ï¼Œä¸€éµè·‘å…¨å¥—ä»»å‹™  
- `inference.py`            â† çµ¦ SMILES + Task Descriptor â†’ world model â†’ risk / é æ¸¬  
- `README.md`               â† å®‰è£ã€ç¯„ä¾‹æŒ‡ä»¤ã€çµæœèªªæ˜  

# ğŸ—ï¸ å¯¦ä½œç´°ç¯€  
## 1. LangGraph LLM Agent (`agent/llm_agent.py`)  
```python
class LangGraphAgent:
    """
    - ä½¿ç”¨ LangGraph DAGï¼šç¯€é»åŒ…å« Planner, LLM (GPT-3.5/4), Critic
    - æ”¯æ´ 'plan-execute-reflect' è¿´åœˆ
    - æ–¹æ³• generate(n, task_emb) -> List[smiles]
    """

2. Graph-GA åŒ…è£ (agent/graph_ga_wrapper.py)
	â€¢	ç›´æ¥

from guacamol_baselines.graph_ga.goal_directed_generation import GB_GA_generate


	â€¢	å‡½å¼ ga_generate(n, scoring_function) -> List[smiles]

3. Meta Policy (agent/policy.py)
	â€¢	Glues LangGraphAgent & ga_generate
	â€¢	å¤šè‡‚ banditï¼šæ ¹æ“šè¿‘æœŸ 50 å€‹å€™é¸å¹³å‡ risk Ã— GuacaMol scoreï¼Œå‹•æ…‹é¸æ“‡ç”Ÿæˆå™¨

4. World Modelï¼šåŒå‰å›ç­”ï¼Œä½† task_encoder.py åŠ ä¸Š

# æ”¯æ´ benchmark_suites:
from guacamol.benchmark_suites import goal_directed_benchmark_suite
TASK_LIST = [b.name for b in goal_directed_benchmark_suite()]

5. é¢¨éšª Gate (world_model/gate.py)

risk = sigmoid( w1*(1-p_synth) + w2*p_tox + w3*Ïƒ_sum + w4*cost_norm + w5*novelty )

novelty = 1 - max cosine similarity èˆ‡æ­·å² top-k åµŒå…¥

6. Benchmark Runner (benchmark/guacamol_runner.py)
	1.	è¼‰å…¥ goal_directed_benchmark_suite() æä¾›çš„æ‰€æœ‰ä»»å‹™
	2.	å°æ¯å€‹ä»»å‹™ï¼š
	â€¢	ç”¢ç”Ÿ Task Descriptor â†’ Task Embedding
	â€¢	agent.policy.next_generator() ç”¢ç”Ÿå€™é¸ â†’ world_model â†’ Gate â†’ è‹¥ riskâ‰¤Ï„ â†’ GuacaMol scoring fn
	3.	è¨˜éŒ„åˆ†å­æ•¸ã€å¹³å‡ Oracle æ¬¡æ•¸ã€æœ€çµ‚åˆ†æ•¸

7. ä¾è³´å®‰è£ (README ç¯„ä¾‹)

conda create -n molwm python=3.9 && conda activate molwm
pip install torch==2.* torch_geometric==2.* rdkit-pypi \
            guacamol==0.5.2 guacamol-baselines langgraph==0.4.*

8. ä¸€éµæŒ‡ä»¤
	â€¢	é è¨“ç·´ï¼špython training/train_pretrain.py --epochs 50
	â€¢	å¾®èª¿ ï¼špython training/train_finetune.py --epochs 30
	â€¢	å–® SMILES æ¸¬è©¦ï¼š

python inference.py \
   --smiles "CC1=CC(=O)NC(=O)N1" \
   --task_name "logP" --op ">=" --value 2.5


	â€¢	è·‘ GuacaMol å…¨ä»»å‹™ï¼š

python benchmark/guacamol_runner.py --oracle_budget 200



ğŸ–‹ï¸ è¼¸å‡ºæ ¼å¼èªªæ˜

è«‹ Codex ä¾ä¸‹åˆ—æ ¼å¼ä¸€æ¬¡ç”Ÿæˆæ‰€æœ‰æª”æ¡ˆï¼š

===== <relative_path/filename.py> =====
<code>

å…¶ä¸­ <code> ç‚ºå¯ç›´æ¥åŸ·è¡Œçš„å®Œæ•´ç¨‹å¼ï¼›stub æ®µä»¥ TODO: è¨»è§£æ¨™ç¤ºã€‚

 æœŸæœ›çµæœ
	â€¢	åŸ·è¡Œ python benchmark/guacamol_runner.pyï¼šæ•´é«”å¾—åˆ† â‰¥ å®˜æ–¹ random baselineï¼›Oracle å¬å–šæ¬¡æ•¸ â‰¤ --oracle_budgetã€‚
	â€¢	æ‰€æœ‰å–®å…ƒæ¸¬è©¦èˆ‡ python -m pytest éé—œã€‚

 é–‹å§‹ç”Ÿæˆ å…¨éƒ¨æª”æ¡ˆï¼

